Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Select jobs to execute...

[Sat Oct  9 23:42:31 2021]
rule cnnscorevariants:
    input: /fs03/pg32/zarul/results/single_calling/genotype_gvcf/PRS006.vcf.gz, /fs03/pg32/zarul/results/single_calling/genotype_gvcf/PRS006.vcf.gz.tbi, /fs03/pg32/zarul/results/preprocessing/gatk_applybqsr/PRS006_recal.bam, /fs03/pg32/zarul/results/preprocessing/gatk_applybqsr/PRS006_recal.bai, /fs03/pg32/zarul/results/GRCh38_full_analysis_set_plus_decoy_hla.fa
    output: /fs03/pg32/zarul/results/single_calling/cnnscorevariants/PRS006.vcf.gz, /fs03/pg32/zarul/results/single_calling/cnnscorevariants/PRS006.vcf.gz.tbi, /fs03/pg32/zarul/results/single_calling/cnnscorevariants/.temp_PRS006
    log: /fs03/pg32/zarul/results/log/single_calling/cnnscorevariants/PRS006.log
    jobid: 0
    wildcards: sample=PRS006
    resources: mem_mb=50000, disk_mb=23924, tmpdir=/tmp

Activating singularity image /projects/pg32/WES_preliminary_analyses/.snakemake/singularity/c25fcccac22093779d3bc7c101442daf.simg
INFO:    Converting SIF file to temporary sandbox...
12:42:58.354 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/gatk/gatk-package-4.1.3.0-local.jar!/com/intel/gkl/native/libgkl_compression.so
12:42:58.819 INFO  CNNScoreVariants - ------------------------------------------------------------
12:42:58.819 INFO  CNNScoreVariants - The Genome Analysis Toolkit (GATK) v4.1.3.0
12:42:58.819 INFO  CNNScoreVariants - For support and documentation go to https://software.broadinstitute.org/gatk/
12:42:58.819 INFO  CNNScoreVariants - Executing as mzar0002@m3h004 on Linux v3.10.0-1160.11.1.el7.x86_64 amd64
12:42:58.819 INFO  CNNScoreVariants - Java runtime: OpenJDK 64-Bit Server VM v1.8.0_191-8u191-b12-0ubuntu0.16.04.1-b12
12:42:58.820 INFO  CNNScoreVariants - Start Date/Time: October 9, 2021 12:42:58 PM UTC
12:42:58.820 INFO  CNNScoreVariants - ------------------------------------------------------------
12:42:58.820 INFO  CNNScoreVariants - ------------------------------------------------------------
12:42:58.820 INFO  CNNScoreVariants - HTSJDK Version: 2.20.1
12:42:58.820 INFO  CNNScoreVariants - Picard Version: 2.20.5
12:42:58.820 INFO  CNNScoreVariants - HTSJDK Defaults.COMPRESSION_LEVEL : 2
12:42:58.820 INFO  CNNScoreVariants - HTSJDK Defaults.USE_ASYNC_IO_READ_FOR_SAMTOOLS : false
12:42:58.821 INFO  CNNScoreVariants - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_SAMTOOLS : true
12:42:58.821 INFO  CNNScoreVariants - HTSJDK Defaults.USE_ASYNC_IO_WRITE_FOR_TRIBBLE : false
12:42:58.821 INFO  CNNScoreVariants - Deflater: IntelDeflater
12:42:58.821 INFO  CNNScoreVariants - Inflater: IntelInflater
12:42:58.821 INFO  CNNScoreVariants - GCS max retries/reopens: 20
12:42:58.821 INFO  CNNScoreVariants - Requester pays: disabled
12:42:58.821 INFO  CNNScoreVariants - Initializing engine
12:42:59.748 INFO  FeatureManager - Using codec VCFCodec to read file file:///fs03/pg32/zarul/results/single_calling/genotype_gvcf/PRS006.vcf.gz
12:43:00.094 INFO  CNNScoreVariants - Done initializing engine
12:43:00.095 INFO  NativeLibraryLoader - Loading libgkl_utils.so from jar:file:/gatk/gatk-package-4.1.3.0-local.jar!/com/intel/gkl/native/libgkl_utils.so
12:43:02.359 INFO  CNNScoreVariants - Using key:CNN_2D for CNN architecture:/tmp/small_2d.51812048018116274.json and weights:/tmp/small_2d.2348784648666873997.hd5
12:43:03.115 INFO  ProgressMeter - Starting traversal
12:43:03.116 INFO  ProgressMeter -        Current Locus  Elapsed Minutes    Variants Processed  Variants/Minute
12:43:03.120 INFO  CNNScoreVariants - Starting pass 0 through the variants
12:43:13.131 INFO  ProgressMeter -        chr1:91797317              0.2                  1000           5991.6
12:44:59.760 INFO  ProgressMeter -       chr1:207708212              1.9                  2000           1028.8
12:46:42.809 INFO  ProgressMeter -       chr2:108247311              3.7                  3000            819.3
12:48:23.456 INFO  ProgressMeter -        chr3:19950940              5.3                  4000            749.2
12:50:04.921 INFO  ProgressMeter -       chr3:186677783              7.0                  5000            711.2
12:51:47.341 INFO  ProgressMeter -         chr5:7743674              8.7                  6000            686.7
12:53:27.526 INFO  ProgressMeter -        chr6:25769121             10.4                  7000            672.6
12:55:08.815 INFO  ProgressMeter -        chr7:25228315             12.1                  8000            661.4
12:56:54.489 INFO  ProgressMeter -         chr8:6708830             13.9                  9000            649.5
12:58:36.525 INFO  ProgressMeter -        chr9:83663902             15.6                 10000            642.8
13:00:17.225 INFO  ProgressMeter -       chr10:75094806             17.2                 11000            638.2
13:02:01.024 INFO  ProgressMeter -       chr11:18245480             19.0                 12000            632.7
13:03:43.988 INFO  ProgressMeter -         chr12:885321             20.7                 13000            628.6
13:05:24.474 INFO  ProgressMeter -      chr12:124911942             22.4                 14000            626.2
13:07:05.669 INFO  ProgressMeter -       chr14:88011069             24.0                 15000            623.9
13:08:48.504 INFO  ProgressMeter -        chr16:1614930             25.8                 16000            621.2
13:10:29.494 INFO  ProgressMeter -        chr17:8231743             27.4                 17000            619.5
13:12:12.113 INFO  ProgressMeter -        chr18:8387197             29.1                 18000            617.5
13:13:52.947 INFO  ProgressMeter -       chr19:15914366             30.8                 19000            616.3
13:15:35.491 INFO  ProgressMeter -       chr19:55518098             32.5                 20000            614.6
13:17:17.205 INFO  ProgressMeter -       chr22:19764306             34.2                 21000            613.4
13:18:11.243 INFO  CNNScoreVariants - Finished pass 0 through the variants
13:19:27.564 INFO  CNNScoreVariants - Starting pass 1 through the variants
13:19:27.623 INFO  ProgressMeter -         chr1:8358584             36.4                 22000            604.3
13:19:29.177 INFO  CNNScoreVariants - Finished pass 1 through the variants
13:19:29.190 INFO  CNNScoreVariants - No variants filtered by: AllowAllVariantsVariantFilter
13:19:29.192 INFO  CNNScoreVariants - No reads filtered by: (WellformedReadFilter AND ReadGroupBlackListReadFilter)
13:19:29.192 INFO  ProgressMeter -       chr22:30579874             36.4                 43694           1199.2
13:19:29.192 INFO  ProgressMeter - Traversal complete. Processed 43694 total variants in 36.4 minutes.
13:19:29.192 INFO  CNNScoreVariants - Done scoring variants with CNN.
13:19:29.365 INFO  CNNScoreVariants - Shutting down engine
[October 9, 2021 1:19:29 PM UTC] org.broadinstitute.hellbender.tools.walkers.vqsr.CNNScoreVariants done. Elapsed time: 36.52 minutes.
Runtime.totalMemory()=2076049408
Using GATK jar /gatk/gatk-package-4.1.3.0-local.jar
Running:
    java -Dsamjdk.use_async_io_read_samtools=false -Dsamjdk.use_async_io_write_samtools=true -Dsamjdk.use_async_io_write_tribble=false -Dsamjdk.compression_level=2 -Xmx50G -jar /gatk/gatk-package-4.1.3.0-local.jar CNNScoreVariants -I /fs03/pg32/zarul/results/preprocessing/gatk_applybqsr/PRS006_recal.bam -V /fs03/pg32/zarul/results/single_calling/genotype_gvcf/PRS006.vcf.gz -R /fs03/pg32/zarul/results/GRCh38_full_analysis_set_plus_decoy_hla.fa -O /fs03/pg32/zarul/results/single_calling/cnnscorevariants/PRS006.vcf.gz -tensor-type read_tensor
INFO:    Cleaning up image...
Touching output file /fs03/pg32/zarul/results/single_calling/cnnscorevariants/.temp_PRS006.
[Sun Oct 10 00:19:31 2021]
Finished job 0.
1 of 1 steps (100%) done
